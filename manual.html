
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>1 Introduction &#8212; SiSi4S  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="SiSi4S" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="index.html" title="SiSi4S"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SiSi4S  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">1 Introduction</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <nav class="contents" id="contents" role="doc-toc">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id21">1 Introduction</a></p></li>
<li><p><a class="reference internal" href="#building" id="id22">2 Building</a></p>
<ul>
<li><p><a class="reference internal" href="#intel-tools" id="id23">2.1 Intel tools</a></p>
<ul>
<li><p><a class="reference internal" href="#intel-compiler" id="id24">2.1.1 Intel compiler</a></p></li>
<li><p><a class="reference internal" href="#mkl-libraries" id="id25">2.1.2 <code class="docutils literal notranslate"><span class="pre">MKL</span></code> libraries</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#todo-libint" id="id26">2.2 TODO Libint</a></p></li>
<li><p><a class="reference internal" href="#todo-ctf" id="id27">2.3 TODO CTF</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#input" id="id28">3 Input</a></p>
<ul>
<li><p><a class="reference internal" href="#yaml" id="id29">3.1 Yaml</a></p>
<ul>
<li><p><a class="reference internal" href="#disabling-steps" id="id30">3.1.1 Disabling steps</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#todo-developer-s-corner" id="id31">4 TODO Developer’s corner</a></p>
<ul>
<li><p><a class="reference internal" href="#todo-writing-documentation" id="id32">4.1 TODO Writing documentation</a></p></li>
<li><p><a class="reference internal" href="#todo-adding-new-algorithms" id="id33">4.2 TODO Adding new algorithms</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#technical-details" id="id34">5 Technical details</a></p>
<ul>
<li><p><a class="reference internal" href="#binary-tensor-file-format" id="id35">5.1 Binary tensor file format</a></p>
<ul>
<li><p><a class="reference internal" href="#header" id="id36">5.1.1 Header</a></p>
<ul>
<li><p><a class="reference internal" href="#tensor-flags" id="id37">5.1.1.1 Tensor flags</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#dimension-information" id="id38">5.1.2 Dimension information</a></p>
<ul>
<li><p><a class="reference internal" href="#dimension-flags" id="id39">5.1.2.1 Dimension flags</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#variable-chunks" id="id40">5.1.3 Variable chunks</a></p>
<ul>
<li><p><a class="reference internal" href="#symmetry-chunk" id="id41">5.1.3.1 Symmetry chunk</a></p>
<ul>
<li><p><a class="reference internal" href="#symmetry-flags" id="id42">5.1.3.1.1 Symmetry flags</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#tensor-data" id="id43">5.1.4 Tensor data</a></p>
<ul>
<li><p><a class="reference internal" href="#sequential-values" id="id44">5.1.4.1 Sequential values</a></p></li>
<li><p><a class="reference internal" href="#index-value-storage" id="id45">5.1.4.2 Index-value storage</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#fourier-transformed-overlap-densities" id="id46">5.2 Fourier Transformed Overlap Densities</a></p>
<ul>
<li><p><a class="reference internal" href="#id12" id="id47">5.2.1 Header</a></p></li>
<li><p><a class="reference internal" href="#overlap-densities" id="id48">5.2.2 Overlap densities</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#fourier-transformed-overlap-densities-binary" id="id49">5.3 Fourier Transformed Overlap Densities - Binary</a></p>
<ul>
<li><p><a class="reference internal" href="#id15" id="id50">5.3.1 Header</a></p></li>
<li><p><a class="reference internal" href="#data-chunks" id="id51">5.3.2 Data Chunks</a></p>
<ul>
<li><p><a class="reference internal" href="#real-part-of-chi" id="id52">5.3.2.1 Real part of <span class="math notranslate nohighlight">\(\chi\)</span></a></p></li>
<li><p><a class="reference internal" href="#imaginary-part-of-chi" id="id53">5.3.2.2 Imaginary part of <span class="math notranslate nohighlight">\(\chi\)</span></a></p></li>
<li><p><a class="reference internal" href="#real-part-of-chi-i-a" id="id54">5.3.2.3 Real part of <span class="math notranslate nohighlight">\(\chi_i^a\)</span></a></p></li>
<li><p><a class="reference internal" href="#imaginary-part-of-chi-i-a" id="id55">5.3.2.4 Imaginary part of <span class="math notranslate nohighlight">\(\chi_i^a\)</span></a></p></li>
<li><p><a class="reference internal" href="#eigenenergies-varepsilon-p" id="id56">5.3.2.5 Eigenenergies <span class="math notranslate nohighlight">\(\varepsilon_p\)</span></a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#algorithms" id="id57">6 Algorithms</a></p>
<ul>
<li><p><a class="reference internal" href="#moreader" id="id58">6.1 MoReader</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h1><a class="toc-backref" href="#id21" role="doc-backlink">1 Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">SiSi4S</span></code> is a massively-parallel quantum chemistry code
that aims to bring coupled-cluster theories to solid state
systems.
<code class="docutils literal notranslate"><span class="pre">SiSi4S</span></code> is based partially on the unpublished version of the <a class="reference external" href="https://github.com/cc4s/cc4s">CC4S</a>
code and is used as a testing ground by some developers.</p>
</section>
<section id="building">
<h1><a class="toc-backref" href="#id22" role="doc-backlink">2 Building</a><a class="headerlink" href="#building" title="Permalink to this heading">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">SiSi4S</span></code> depends on several libraries to build.
In principle, <code class="docutils literal notranslate"><span class="pre">SiSi4S</span></code> can build all the dependencies itself, with the exception of the boost libraries,
which are available in most <code class="docutils literal notranslate"><span class="pre">HPC</span></code> systems.</p>
<section id="intel-tools">
<h2><a class="toc-backref" href="#id23" role="doc-backlink">2.1 Intel tools</a><a class="headerlink" href="#intel-tools" title="Permalink to this heading">¶</a></h2>
<section id="intel-compiler">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">2.1.1 Intel compiler</a><a class="headerlink" href="#intel-compiler" title="Permalink to this heading">¶</a></h3>
<p>In general, the configure script should make a good job of finding the correct intel
compiler and the correct <code class="docutils literal notranslate"><span class="pre">`mkl</span></code> &lt;<a class="reference external" href="https://www.intel.com/content/www/us/en/develop/documentation/get-started-with-mkl-for-dpcpp/top.html%20">https://www.intel.com/content/www/us/en/develop/documentation/get-started-with-mkl-for-dpcpp/top.html%20</a>&gt;`_ libraries.</p>
<p>This section documents past instances of issues and correct solutions to the building.</p>
<p>Make sure to provide correct <code class="docutils literal notranslate"><span class="pre">mpi</span></code> wrapper scripts to the configure script, for instance
supply <code class="docutils literal notranslate"><span class="pre">MPICXX</span></code> and <code class="docutils literal notranslate"><span class="pre">CXX</span></code> variables to the <code class="docutils literal notranslate"><span class="pre">./configure</span></code> script:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./configure <span class="nv">MPICXX</span><span class="o">=</span>mpiicc <span class="nv">CXX</span><span class="o">=</span>icc
</pre></div>
</div>
</section>
<section id="mkl-libraries">
<h3><a class="toc-backref" href="#id25" role="doc-backlink">2.1.2 <code class="docutils literal notranslate"><span class="pre">MKL</span></code> libraries</a><a class="headerlink" href="#mkl-libraries" title="Permalink to this heading">¶</a></h3>
<p>Typically, the module systems in HPC clusters will export shell variables
with names prefixed by <code class="docutils literal notranslate"><span class="pre">MKL</span></code>, for instance</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MKLROOT</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MKL_HOME</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MKL_PARTS_HOME</span></code></p></li>
</ul>
<p>It is possible that the configure script can not discover the <code class="docutils literal notranslate"><span class="pre">BLAS</span></code> libraries,
in which case you can test the following</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./configure <span class="se">\</span>
    <span class="nv">MPICXX</span><span class="o">=</span>mpiicc <span class="se">\</span>
    <span class="nv">CXX</span><span class="o">=</span>icc <span class="se">\</span>
    --with-blas<span class="o">=</span><span class="s2">&quot;-L</span><span class="si">${</span><span class="nv">MKL_HOME</span><span class="si">}</span><span class="s2">/lib/intel64/ -mkl -lmkl_intel_lp64&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="todo-libint">
<h2><a class="toc-backref" href="#id26" role="doc-backlink">2.2 TODO Libint</a><a class="headerlink" href="#todo-libint" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">BOOST_ROOT</span></code></p></li>
</ul>
</section>
<section id="todo-ctf">
<h2><a class="toc-backref" href="#id27" role="doc-backlink">2.3 TODO CTF</a><a class="headerlink" href="#todo-ctf" title="Permalink to this heading">¶</a></h2>
</section>
</section>
<section id="input">
<h1><a class="toc-backref" href="#id28" role="doc-backlink">3 Input</a><a class="headerlink" href="#input" title="Permalink to this heading">¶</a></h1>
<section id="yaml">
<h2><a class="toc-backref" href="#id29" role="doc-backlink">3.1 Yaml</a><a class="headerlink" href="#yaml" title="Permalink to this heading">¶</a></h2>
<p>For now the main input format of <code class="docutils literal notranslate"><span class="pre">SiSi4S</span></code>
is yaml. A typical input for an algorithm is the following</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">UccsdAmplitudesFromCoulombIntegrals</span><span class="w"></span>
<span class="w">  </span><span class="nt">in</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">energyConvergence</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1e-8</span><span class="w"></span>
<span class="w">    </span><span class="nt">maxIterations</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span><span class="w"></span>
<span class="w">    </span><span class="nt">antisymmetrize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w"></span>
<span class="w">    </span><span class="nt">unrestricted</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w"></span>
<span class="w">    </span><span class="nt">mixer</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DiisMixer&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">maxResidua</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span><span class="w"></span>
<span class="w">    </span><span class="nt">HoleEigenEnergies</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$HoleEigenEnergies</span><span class="w"></span>
<span class="w">    </span><span class="nt">ParticleEigenEnergies</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$ParticleEigenEnergies</span><span class="w"></span>
<span class="w">    </span><span class="nt">HHHHCoulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$HHHHCoulombIntegrals</span><span class="w"></span>
<span class="w">    </span><span class="nt">PPPPCoulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$PPPPCoulombIntegrals</span><span class="w"></span>
<span class="w">    </span><span class="nt">HHHPCoulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$HHHPCoulombIntegrals</span><span class="w"></span>
<span class="w">    </span><span class="nt">HHPPCoulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$HHPPCoulombIntegrals</span><span class="w"></span>
<span class="w">    </span><span class="nt">HPHHCoulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$HPHHCoulombIntegrals</span><span class="w"></span>
<span class="w">    </span><span class="nt">HPHPCoulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$HPHPCoulombIntegrals</span><span class="w"></span>
<span class="w">    </span><span class="nt">HPPPCoulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$HPPPCoulombIntegrals</span><span class="w"></span>
<span class="w">    </span><span class="nt">PPHHCoulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$PPHHCoulombIntegrals</span><span class="w"></span>
<span class="w">    </span><span class="nt">PPHPCoulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$PPHPCoulombIntegrals</span><span class="w"></span>
<span class="w">    </span><span class="nt">HPPHCoulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$HPPHCoulombIntegrals</span><span class="w"></span>
<span class="w">    </span><span class="nt">PHPPCoulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$PHPPCoulombIntegrals</span><span class="w"></span>
<span class="w">    </span><span class="nt">HHPHCoulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$HHPHCoulombIntegrals</span><span class="w"></span>
<span class="w">    </span><span class="nt">PPPHCoulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$PPPHCoulombIntegrals</span><span class="w"></span>
<span class="w">    </span><span class="nt">PHPHCoulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$PHPHCoulombIntegrals</span><span class="w"></span>
<span class="w">    </span><span class="nt">PHHPCoulombIntegrals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$PHHPCoulombIntegrals</span><span class="w"></span>
<span class="w">  </span><span class="nt">out</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">UccsdDoublesAmplitudes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$UccsdDoublesAmplitudes</span><span class="w"></span>
<span class="w">    </span><span class="nt">UccsdSinglesAmplitudes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$UccsdSinglesAmplitudes</span><span class="w"></span>
<span class="w">    </span><span class="nt">UccsdEnergy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$UccsdEnergy</span><span class="w"></span>
</pre></div>
</div>
<p>From here, we can see that every algorithm block consists
of an `in` section and an `out` section.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">UccsdAmplitudesFromCoulombIntegrals</span><span class="w"></span>
<span class="w">  </span><span class="nt">in</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span><span class="w"></span>
<span class="w">  </span><span class="nt">out</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span><span class="w"></span>
</pre></div>
</div>
<p>Some rules extending yaml semantics have to be considered.
Strings that start with a <code class="docutils literal notranslate"><span class="pre">$</span></code> sign are internal variables
such as tensors. The reason of forcing this is to
differentiate between yaml strings and symbols
representing the name of an internal tensor.</p>
<section id="disabling-steps">
<h3><a class="toc-backref" href="#id30" role="doc-backlink">3.1.1 Disabling steps</a><a class="headerlink" href="#disabling-steps" title="Permalink to this heading">¶</a></h3>
<p>If you have a big file and you want to disable a step,
in addition to <code class="docutils literal notranslate"><span class="pre">in</span></code> and <code class="docutils literal notranslate"><span class="pre">out</span></code>, you can supply a <code class="docutils literal notranslate"><span class="pre">disable</span></code>
section with values <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>, i.e.,</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">UccsdAmplitudesFromCoulombIntegrals</span><span class="w"></span>
<span class="w">  </span><span class="nt">disable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">  </span><span class="nt">in</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span><span class="w"></span>
<span class="w">  </span><span class="nt">out</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span><span class="w"></span>
</pre></div>
</div>
<p>will simply ignore <code class="docutils literal notranslate"><span class="pre">UccsdAmplitudesFromCoulombIntegrals</span></code>.</p>
</section>
</section>
</section>
<section id="todo-developer-s-corner">
<h1><a class="toc-backref" href="#id31" role="doc-backlink">4 TODO Developer’s corner</a><a class="headerlink" href="#todo-developer-s-corner" title="Permalink to this heading">¶</a></h1>
<section id="todo-writing-documentation">
<h2><a class="toc-backref" href="#id32" role="doc-backlink">4.1 TODO Writing documentation</a><a class="headerlink" href="#todo-writing-documentation" title="Permalink to this heading">¶</a></h2>
</section>
<section id="todo-adding-new-algorithms">
<h2><a class="toc-backref" href="#id33" role="doc-backlink">4.2 TODO Adding new algorithms</a><a class="headerlink" href="#todo-adding-new-algorithms" title="Permalink to this heading">¶</a></h2>
</section>
</section>
<section id="technical-details">
<h1><a class="toc-backref" href="#id34" role="doc-backlink">5 Technical details</a><a class="headerlink" href="#technical-details" title="Permalink to this heading">¶</a></h1>
<section id="binary-tensor-file-format">
<span id="id1"></span><h2><a class="toc-backref" href="#id35" role="doc-backlink">5.1 Binary tensor file format</a><a class="headerlink" href="#binary-tensor-file-format" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>all integers in the headers are encoded in
<a class="reference external" href="https://en.wikipedia.org/wiki/Endianness">little endian</a>.</p></li>
</ul>
<section id="header">
<h3><a class="toc-backref" href="#id36" role="doc-backlink">5.1.1 Header</a><a class="headerlink" href="#header" title="Permalink to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Content</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+0</p></td>
<td><p>“TENS”</p></td>
<td><p>char</p></td>
<td><p>4</p></td>
<td><p>magic</p></td>
</tr>
<tr class="row-odd"><td><p>+4</p></td>
<td><p>version</p></td>
<td><p>integer</p></td>
<td><p>4</p></td>
<td><p>version number in hex, e.g. 1.0 = 0x00010000 = 65536</p></td>
</tr>
<tr class="row-even"><td><p>+8</p></td>
<td><p>number type</p></td>
<td><p>character</p></td>
<td><p>4</p></td>
<td><p>“uint”, “UINT”, “sint”, “SINT” for unsigned or signed integers, respectively, “IEEE” for IEEE floating point numbers. Capital case integer types refer to big-, lower case to little endian encoding.</p></td>
</tr>
<tr class="row-odd"><td><p>+12</p></td>
<td><p>bytes per number</p></td>
<td><p>integer</p></td>
<td><p>4</p></td>
<td><p>Integer numbers may be 1,2,4,8 or 16 bytes in size while IEEE floats may be 4,8 or 16 bytes referring to single,double or quadruple precision.</p></td>
</tr>
<tr class="row-even"><td><p>+16</p></td>
<td><p>numbers per tensor element</p></td>
<td><p>integer</p></td>
<td><p>4</p></td>
<td><p>1,2,4 or 8 for real, complex, quaternionic or octonionic tensors</p></td>
</tr>
<tr class="row-odd"><td><p>+20</p></td>
<td><p>order <span class="math notranslate nohighlight">\(N\)</span></p></td>
<td><p>integer</p></td>
<td><p>4</p></td>
<td><p>the number of dimensions</p></td>
</tr>
<tr class="row-even"><td><p>+24</p></td>
<td><p>flags</p></td>
<td><p>integer</p></td>
<td><p>4</p></td>
<td><p>32 bit flags defined below (0 for dense tensor)</p></td>
</tr>
<tr class="row-odd"><td><p>+28</p></td>
<td><p>zero</p></td>
<td><p>bytes</p></td>
<td><p>4</p></td>
<td><p>reserved for future use</p></td>
</tr>
<tr class="row-even"><td><p>+32</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>&lt;note&gt;TODO: alignment of data chunks or not&lt;/note&gt;</p>
<section id="tensor-flags">
<span id="id2"></span><h4><a class="toc-backref" href="#id37" role="doc-backlink">5.1.1.1 Tensor flags</a><a class="headerlink" href="#tensor-flags" title="Permalink to this heading">¶</a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Bit</p></th>
<th class="head"><p>31 - 1</p></th>
<th class="head"><p>0</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Flag</p></td>
<td><p>reserved for future use</p></td>
<td><p>IX</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Flag</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>IX</p></td>
<td><p>data stored in (index,value) pairs</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="dimension-information">
<span id="id3"></span><h3><a class="toc-backref" href="#id38" role="doc-backlink">5.1.2 Dimension information</a><a class="headerlink" href="#dimension-information" title="Permalink to this heading">¶</a></h3>
<p>After the tensor header, dimension headers follow for each dimension,
starting with the leftmost index.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Content</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+0</p></td>
<td><p>length</p></td>
<td><p>integer</p></td>
<td><p>4</p></td>
<td><p>the length the respective dimension</p></td>
</tr>
<tr class="row-odd"><td><p>+4</p></td>
<td><p>index name</p></td>
<td><p>character</p></td>
<td><p>1</p></td>
<td><p>index name for later reference</p></td>
</tr>
<tr class="row-even"><td><p>+5</p></td>
<td><p>flags</p></td>
<td><p>integer</p></td>
<td><p>1</p></td>
<td><p>8-bit flags of this dimension</p></td>
</tr>
<tr class="row-odd"><td><p>+6</p></td>
<td><p>zero</p></td>
<td><p>bytes</p></td>
<td><p>2</p></td>
<td><p>reserved for future use</p></td>
</tr>
<tr class="row-even"><td><p>+8</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<section id="dimension-flags">
<span id="id4"></span><h4><a class="toc-backref" href="#id39" role="doc-backlink">5.1.2.1 Dimension flags</a><a class="headerlink" href="#dimension-flags" title="Permalink to this heading">¶</a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Bit</p></th>
<th class="head"><p>7-1</p></th>
<th class="head"><p>0</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Flag</p></td>
<td><p>reserved for future use</p></td>
<td><p>SP</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Flag</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SP</p></td>
<td><p>whether this dimension is sparse</p></td>
</tr>
</tbody>
</table>
<p>Note that sparsity in any dimension does not require the tensor to be
stored in the (index,value) format, although that would be the usual
case.</p>
</section>
</section>
<section id="variable-chunks">
<span id="id5"></span><h3><a class="toc-backref" href="#id40" role="doc-backlink">5.1.3 Variable chunks</a><a class="headerlink" href="#variable-chunks" title="Permalink to this heading">¶</a></h3>
<p>After the fixed chunks for each tensor dimension come the variable
chunks providing additional information on the structure of the tensor
data, such as on symmetry relations. Each variable chunk provides the
same header information including information on its total size, such
that implementations can skip ignored or unknown chunks.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Content</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+0</p></td>
<td><p>magic</p></td>
<td><p>characters</p></td>
<td><p>8</p></td>
<td><p>identifying the respective chunk</p></td>
</tr>
<tr class="row-odd"><td><p>+8</p></td>
<td><p>total size</p></td>
<td><p>integer</p></td>
<td><p>8</p></td>
<td><p>including all fields, must be a multiple of 8</p></td>
</tr>
<tr class="row-even"><td><p>+16</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<section id="symmetry-chunk">
<span id="id6"></span><h4><a class="toc-backref" href="#id41" role="doc-backlink">5.1.3.1 Symmetry chunk</a><a class="headerlink" href="#symmetry-chunk" title="Permalink to this heading">¶</a></h4>
<p>Symmetry information for each known symmetry operation on the tensor’s
index order. Each symmetry operation consists of a permutation
<span class="math notranslate nohighlight">\(\sigma(a,b,\ldots)\)</span> of the indices and a subsequent operation <span class="math notranslate nohighlight">\(s(x)\)</span> on
the elements, which leave the tensor invariant. For instance,
anti-symmetry when interchanging the first two indices in a tensor of
fourth order is specified by</p>
<div class="math notranslate nohighlight">
\[\begin{split}T_{ijkl} =
s\left(T_{\sigma(i,j,k,l)}\right)\,, \text{ with } s(x) = -x \text{ and
} \sigma = \left(\begin{array}{rrrr} 1&amp;2&amp;3&amp;4\\
2&amp;1&amp;3&amp;4 \end{array}\right)\,.\end{split}\]</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Content</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+0</p></td>
<td><p>“SYMMETRY”</p></td>
<td><p>characters</p></td>
<td><p>8</p></td>
<td><p>magic</p></td>
</tr>
<tr class="row-odd"><td><p>+8</p></td>
<td><p>size of symmetry information</p></td>
<td><p>integer</p></td>
<td><p>8</p></td>
<td><p>including all fields, must be a multiple of 8</p></td>
</tr>
<tr class="row-even"><td><p>+16</p></td>
<td><p>flags</p></td>
<td><p>integer</p></td>
<td><p>1</p></td>
<td><p>8-bit flags of this symmetry</p></td>
</tr>
<tr class="row-odd"><td><p>+17</p></td>
<td><p>length <span class="math notranslate nohighlight">\(n\)</span> of the operation code</p></td>
<td><p>integer</p></td>
<td><p>1</p></td>
<td><p>characters in the code of the operation <span class="math notranslate nohighlight">\(s(x)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>+18</p></td>
<td><p>symmetry operation code</p></td>
<td><p>characters</p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p>code of the symmetry operation, e.g. “-x” for <span class="math notranslate nohighlight">\(s(x)=-x\)</span></p></td>
</tr>
<tr class="row-odd"><td><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> + 18</p></li>
</ul>
</td>
<td><p>index map of <span class="math notranslate nohighlight">\(\sigma\)</span></p></td>
<td><p>characters</p></td>
<td><p><span class="math notranslate nohighlight">\(N\)</span></p></td>
<td><p>the symmetry permutation of the index names given in the dimension information, e.g. “bacd” for a transposition of the first two indices for a tensor with the index names “abcd”</p></td>
</tr>
<tr class="row-even"><td><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N\)</span> + <span class="math notranslate nohighlight">\(n\)</span> + 18</p></li>
</ul>
</td>
<td><p>padding zeros</p></td>
<td><p>bytes</p></td>
<td><p><span class="math notranslate nohighlight">\(\textrm{pad}_8(N+n+18)\)</span></p></td>
<td><p>padding to align the chunks in multiples of 4 bytes</p></td>
</tr>
<tr class="row-odd"><td><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\textrm{align}_8 (N+n+18)\)</span></p></li>
</ul>
</td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>where <span class="math notranslate nohighlight">\(\textrm{align}_a(N)=a\lceil N/a \rceil\)</span>
and <span class="math notranslate nohighlight">\(\mathrm{pad}_a(N)=\mathrm{align}_a(N)-N\)</span>.</p>
<section id="symmetry-flags">
<span id="id7"></span><h5><a class="toc-backref" href="#id42" role="doc-backlink">5.1.3.1.1 Symmetry flags</a><a class="headerlink" href="#symmetry-flags" title="Permalink to this heading">¶</a></h5>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Bit</p></th>
<th class="head"><p>7-1</p></th>
<th class="head"><p>0</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Flag</p></td>
<td><p>reserved for future use</p></td>
<td><p>PK</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Flag</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PK</p></td>
<td><p>whether the tensor data in this file is packed exploiting this symmetry to reduce the number of entries</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="tensor-data">
<span id="id8"></span><h3><a class="toc-backref" href="#id43" role="doc-backlink">5.1.4 Tensor data</a><a class="headerlink" href="#tensor-data" title="Permalink to this heading">¶</a></h3>
<p>The global index <span class="math notranslate nohighlight">\(I\)</span> of each tensor value is given by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">I</span><span class="o">=</span><span class="n">a</span><span class="o">+</span><span class="n">bN_0</span> <span class="o">+</span> <span class="n">cN_0N_1</span> <span class="o">+</span> \<span class="n">ldots</span>\<span class="p">,,</span>
</pre></div>
</div>
<p>where <span class="math notranslate nohighlight">\(N_0,N_1,\ldots\)</span> is the length of each dimension and
<span class="math notranslate nohighlight">\(a,b,\ldots\)</span> is the index in each dimension in the order given in the
dimension information.</p>
<section id="sequential-values">
<span id="id9"></span><h4><a class="toc-backref" href="#id44" role="doc-backlink">5.1.4.1 Sequential values</a><a class="headerlink" href="#sequential-values" title="Permalink to this heading">¶</a></h4>
<p>If the IX flag is 0 the tensor values are given in a continuous sequence
of ascending global index <span class="math notranslate nohighlight">\(I\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>define symmetry packing for a single transposition
symmetry.</p>
</div>
<p>If the tensor data is packed according to more than one symmetry, only
index-value storage is supported in version 1.0.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Content</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+0</p></td>
<td><p>“DENSDATA”</p></td>
<td><p>characters</p></td>
<td><p>8</p></td>
<td><p>identifying the respective chunk</p></td>
</tr>
<tr class="row-odd"><td><p>+8</p></td>
<td><p>total size</p></td>
<td><p>integer</p></td>
<td><p>8</p></td>
<td><p>including all fields, must be a multiple of 8</p></td>
</tr>
<tr class="row-even"><td><p>+16</p></td>
<td><p><span class="math notranslate nohighlight">\(T(0)\)</span></p></td>
<td><p>tensor element</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{\rm bytes}{\rm number}\frac{\rm numbers}{\rm element}\)</span></p></td>
<td><p>tensor value at <span class="math notranslate nohighlight">\(I=0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>+16 + <span class="math notranslate nohighlight">\(\frac{\rm bytes}{\rm number}\frac{\rm numbers}{\rm element}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(T(1)\)</span></p></td>
<td><p>tensor element</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{\rm bytes}{\rm number}\frac{\rm numbers}{\rm element}\)</span></p></td>
<td><p>tensor value at <span class="math notranslate nohighlight">\(I=1\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
<td><p>tensor element</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{\rm bytes}{\rm number}\frac{\rm numbers}{\rm element}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
</tr>
</tbody>
</table>
</section>
<section id="index-value-storage">
<span id="id10"></span><h4><a class="toc-backref" href="#id45" role="doc-backlink">5.1.4.2 Index-value storage</a><a class="headerlink" href="#index-value-storage" title="Permalink to this heading">¶</a></h4>
<p>If the IX flag is 1 the tensor values are given in pairs of index and
value.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Content</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(+0\)</span></p></td>
<td><p>number of pairs</p></td>
<td><p>integer</p></td>
<td><p>8</p></td>
<td><p>number of non-zero pairs stored</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(+8\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(I_0\)</span></p></td>
<td><p>integer</p></td>
<td><p>8</p></td>
<td><p>global index of first value</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(+16\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(T(I_0)\)</span></p></td>
<td><p>tensor element</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{\rm bytes}{\rm number}\frac{\rm numbers}{\rm element}\)</span></p></td>
<td><p>value of first pair</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(+ \frac{\rm bytes}{\rm number}\frac{\rm numbers}{\rm element} +16\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(I_1\)</span></p></td>
<td><p>integer</p></td>
<td><p>8</p></td>
<td><p>global index of second value</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(+ \frac{\rm bytes}{\rm number}\frac{\rm numbers}{\rm element} +24\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(T(I_1)\)</span></p></td>
<td><p>tensor element</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{\rm bytes}{\rm number}\frac{\rm numbers}{\rm element}\)</span></p></td>
<td><p>value of second pair</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\ldots\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="fourier-transformed-overlap-densities">
<span id="id11"></span><h2><a class="toc-backref" href="#id46" role="doc-backlink">5.2 Fourier Transformed Overlap Densities</a><a class="headerlink" href="#fourier-transformed-overlap-densities" title="Permalink to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">FTOD</span></code> is one of the possible input files, providing information on
the orbitals and the eigenenergies of the reference system. The file
provides the Fourier transformed overlap densities <span class="math notranslate nohighlight">\(\chi_q^p({\bf G})\)</span>
given by</p>
<div class="math notranslate nohighlight">
\[\chi_q^p({\bf G}) = \int{\rm d}{\bf x}\,
    \sqrt{\frac{4\pi}{{\bf G}^2}} {\rm e}^{{\rm i}{\bf G}\cdot{\bf r}}\,
    \psi_p^\ast({\bf x})\psi_q({\bf x}),\]</div>
<p>such that the Coulomb integrals <span class="math notranslate nohighlight">\(V_{sr}^{pq}\)</span> can be decomposed into</p>
<div class="math notranslate nohighlight">
\[V_{sr}^{pq}
=\int\frac{{\rm d}{\bf G}}{(2\pi)^3}\,\chi_s^p({\bf G}){\chi_q^r}^\ast({\bf G})\]</div>
<p>The file is a line based text file of the
following structure</p>
<p>There is also a binary version <code class="docutils literal notranslate"><span class="pre">FTODDUMP</span></code> of this file.</p>
<section id="id12">
<h3><a class="toc-backref" href="#id47" role="doc-backlink">5.2.1 Header</a><a class="headerlink" href="#id12" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>The first line is reserved for comments. It is ignored by cc4s</p></li>
<li><p>The second line provides information on the size of the system. The
columns are white-space separated and they specify</p>
<ol class="arabic simple">
<li><p>the number of occupied orbitals <span class="math notranslate nohighlight">\(n_{\rm o}\)</span></p></li>
<li><p>the number of virtual orbitals <span class="math notranslate nohighlight">\(n_{\rm v}\)</span></p></li>
<li><p>the number of plane waves <span class="math notranslate nohighlight">\(n_{\rm G}\)</span></p></li>
<li><p>the number of spins per orbital, 1 or 2</p></li>
<li><p>the number of <span class="math notranslate nohighlight">\({\bf k}\)</span> points per orbital.</p></li>
</ol>
</li>
<li><p>The third is line is again reserved for comments usually explaining
the structure of the data to follow.</p></li>
</ul>
</section>
<section id="overlap-densities">
<span id="id13"></span><h3><a class="toc-backref" href="#id48" role="doc-backlink">5.2.2 Overlap densities</a><a class="headerlink" href="#overlap-densities" title="Permalink to this heading">¶</a></h3>
<p>The rest of the file contains lines of at least 6 numbers, again in
white-space separated columns:</p>
<ol class="arabic simple">
<li><p>The real part of the overlap density,
<span class="math notranslate nohighlight">\({\rm Re}\left(\chi_q^p({\bf G})\right)\)</span>,
if the plane wave index <span class="math notranslate nohighlight">\(G\)</span>, contained in the third
column, is non-zero,
the eigenenergy <span class="math notranslate nohighlight">\(\varepsilon_p\)</span>, otherwise.</p></li>
<li><p>The imaginary part of the overlap density,
<span class="math notranslate nohighlight">\({\rm Im}\left(\chi_q^p({\bf G})\right)\)</span>,
if the plane wave index in
non-zero. It is ignored otherwise.</p></li>
<li><p>The plane wave index <span class="math notranslate nohighlight">\(G\)</span> ranging from 1 to <span class="math notranslate nohighlight">\(n_{\rm G}\)</span></p></li>
<li><p>The orbital index <span class="math notranslate nohighlight">\(p\)</span>, ranging from 1 to <span class="math notranslate nohighlight">\(n_{\rm o}+n_{\rm v}\)</span></p></li>
<li><p>The orbital index <span class="math notranslate nohighlight">\(q\)</span>, ranging from 1 to <span class="math notranslate nohighlight">\(n_{\rm o}+n_{\rm v}\)</span></p></li>
<li><p>The spin index, which is currently ignored.</p></li>
</ol>
<p>There is no order required by cc4s but it could be beneficial to list
all overlap densities before all eigenenergies for future or other
implementations. Overlap densities that are not listed in the file are
assumed to be zero.</p>
</section>
</section>
<section id="fourier-transformed-overlap-densities-binary">
<span id="id14"></span><h2><a class="toc-backref" href="#id49" role="doc-backlink">5.3 Fourier Transformed Overlap Densities - Binary</a><a class="headerlink" href="#fourier-transformed-overlap-densities-binary" title="Permalink to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">FTODDUMP</span></code> is one of the possible input files, providing information
on the orbitals and the eigenenergies of the reference system. The file
provides the Fourier transformed overlap densities <span class="math notranslate nohighlight">\(\Gamma_{q\bf G}^p\)</span>
given by</p>
<div class="math notranslate nohighlight">
\[\Gamma_{q\bf G}^p = \int{\rm d}{\bf x}\,
    \sqrt{\frac{4\pi}{{\bf G}^2}} {\rm e}^{{\rm i}{\bf G}\cdot{\bf r}}\,
    \psi_p^\ast({\bf x})\psi_q({\bf x}),\]</div>
<p>such that the Coulomb integrals <span class="math notranslate nohighlight">\(V_{sr}^{pq}\)</span> can be decomposed into
<span class="math notranslate nohighlight">\(V_{sr}^{pq}=\int\frac{{\rm d}{\bf G}}{(2\pi)^3}\,{\Gamma^\ast}_s^{p\bf G}\Gamma_{r\bf G}^q\)</span>.
The file is binary.</p>
<p>There is also a text version
<code class="docutils literal notranslate"><span class="pre">FTOD</span></code> of this file.</p>
<p>The file consists of chunks, each starting with a unique character
sequence for identification, called magic. The header must come as first
chunk. The order of the other chunks is arbitrary. The fields within a
chunk are given by their respective offset relative to the start of the
chunk.</p>
<section id="id15">
<span id="id16"></span><h3><a class="toc-backref" href="#id50" role="doc-backlink">5.3.1 Header</a><a class="headerlink" href="#id15" title="Permalink to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Content</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Size</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+0</p></td>
<td><p>“<code class="docutils literal notranslate"><span class="pre">cc4sFTOD</span></code>” (magic)</p></td>
<td><p>character</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p>+8</p></td>
<td><p>number of occupied orbitals <span class="math notranslate nohighlight">\(n_{\rm o}\)</span></p></td>
<td><p>integer</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p>+12</p></td>
<td><p>number of virtual orbitals <span class="math notranslate nohighlight">\(n_{\rm v}\)</span></p></td>
<td><p>integer</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>+16</p></td>
<td><p>number of plane waves <span class="math notranslate nohighlight">\(n_{\rm G}\)</span></p></td>
<td><p>integer</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p>+20</p></td>
<td><p>number of spins, 1 or 2</p></td>
<td><p>integer</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>+24</p></td>
<td><p>number of <span class="math notranslate nohighlight">\({\bf k}\)</span>-points</p></td>
<td><p>integer</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p>+28</p></td>
<td><p>reserved for future use</p></td>
<td><p>zero</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>+32</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="data-chunks">
<span id="id17"></span><h3><a class="toc-backref" href="#id51" role="doc-backlink">5.3.2 Data Chunks</a><a class="headerlink" href="#data-chunks" title="Permalink to this heading">¶</a></h3>
<p>Each chunk starts with an 8 character magic and an 8 byte integer giving
the size of the entire chunk, including the magic and the size field.
The size is provided so that implementations can skip chunks unknown to
them.</p>
<section id="real-part-of-chi">
<span id="id18"></span><h4><a class="toc-backref" href="#id52" role="doc-backlink">5.3.2.1 Real part of <span class="math notranslate nohighlight">\(\chi\)</span></a><a class="headerlink" href="#real-part-of-chi" title="Permalink to this heading">¶</a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Content</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Size</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+0</p></td>
<td><p>“<code class="docutils literal notranslate"><span class="pre">FTODreal</span></code>” (magic)</p></td>
<td><p>character</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p>+8</p></td>
<td><p>size of this chunk in bytes</p></td>
<td><p>integer</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-even"><td><p>+16</p></td>
<td><p><span class="math notranslate nohighlight">\({\rm Re}(\chi_1^1(1))\)</span></p></td>
<td><p>double</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p>+24</p></td>
<td><p><span class="math notranslate nohighlight">\({\rm Re}(\chi_1^1(2))\)</span></p></td>
<td><p>double</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
<td><p>double</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(+16+8n_{\rm G}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\rm Re}(\chi_1^2(1))\)</span></p></td>
<td><p>double</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
<td><p>double</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(+16+8 n_{\rm G}(n_{\rm o}+n_{\rm v})^2\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="imaginary-part-of-chi">
<span id="id19"></span><h4><a class="toc-backref" href="#id53" role="doc-backlink">5.3.2.2 Imaginary part of <span class="math notranslate nohighlight">\(\chi\)</span></a><a class="headerlink" href="#imaginary-part-of-chi" title="Permalink to this heading">¶</a></h4>
<p>Analogous to the real part chunk but with the magic “<code class="docutils literal notranslate"><span class="pre">FTODimag</span></code>”.</p>
</section>
<section id="real-part-of-chi-i-a">
<span id="real-part-of-chi-ia"></span><h4><a class="toc-backref" href="#id54" role="doc-backlink">5.3.2.3 Real part of <span class="math notranslate nohighlight">\(\chi_i^a\)</span></a><a class="headerlink" href="#real-part-of-chi-i-a" title="Permalink to this heading">¶</a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Content</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Size</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+0</p></td>
<td><p>“<code class="docutils literal notranslate"><span class="pre">FTIAreal</span></code>” (magic)</p></td>
<td><p>character</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p>+8</p></td>
<td><p>size of this chunk in bytes</p></td>
<td><p>integer</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-even"><td><p>+16</p></td>
<td><p><span class="math notranslate nohighlight">\({\rm Re}(\chi_1^1(1))\)</span></p></td>
<td><p>double</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p>+24</p></td>
<td><p><span class="math notranslate nohighlight">\({\rm Re}(\chi_1^1(2))\)</span></p></td>
<td><p>double</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
<td><p>double</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(+16+8n_{\rm G}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\rm Re}(\chi_1^2(1))\)</span></p></td>
<td><p>double</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
<td><p>double</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(+16+8n_{\rm G}n_{\rm v}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\rm Re}(\chi_2^1(1))\)</span></p></td>
<td><p>double</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
<td><p>double</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(+16+8n_{\rm G}(n_{\rm o} n_{\rm v})\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="imaginary-part-of-chi-i-a">
<span id="imaginary-part-of-chi-ia"></span><h4><a class="toc-backref" href="#id55" role="doc-backlink">5.3.2.4 Imaginary part of <span class="math notranslate nohighlight">\(\chi_i^a\)</span></a><a class="headerlink" href="#imaginary-part-of-chi-i-a" title="Permalink to this heading">¶</a></h4>
<p>Analogous to the real part chunk but with the magic “<code class="docutils literal notranslate"><span class="pre">FTIAimag</span></code>”.</p>
</section>
<section id="eigenenergies-varepsilon-p">
<span id="id20"></span><h4><a class="toc-backref" href="#id56" role="doc-backlink">5.3.2.5 Eigenenergies <span class="math notranslate nohighlight">\(\varepsilon_p\)</span></a><a class="headerlink" href="#eigenenergies-varepsilon-p" title="Permalink to this heading">¶</a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Content</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Size</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+0</p></td>
<td><p>“<code class="docutils literal notranslate"><span class="pre">FTODepsi</span></code>” (magic)</p></td>
<td><p>character</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p>+8</p></td>
<td><p>size of this chunk in bytes</p></td>
<td><p>integer</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-even"><td><p>+16</p></td>
<td><p><span class="math notranslate nohighlight">\(\varepsilon_1\)</span></p></td>
<td><p>double</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p>+24</p></td>
<td><p><span class="math notranslate nohighlight">\(\varepsilon_2\)</span></p></td>
<td><p>double</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
<td><p>double</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(+16+8(n_{\rm o}+n_{\rm v})\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
</section>
<section id="algorithms">
<h1><a class="toc-backref" href="#id57" role="doc-backlink">6 Algorithms</a><a class="headerlink" href="#algorithms" title="Permalink to this heading">¶</a></h1>
<section id="moreader">
<h2><a class="toc-backref" href="#id58" role="doc-backlink">6.1 MoReader</a><a class="headerlink" href="#moreader" title="Permalink to this heading">¶</a></h2>
<p>This module contains convenience routines in order to read
molecular orbitals from the following codes:</p>
<ul class="simple">
<li><p>NWCHEM</p></li>
<li><p>PSI4</p></li>
<li><p>TURBOMOLE</p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">1 Introduction</a></li>
<li><a class="reference internal" href="#building">2 Building</a><ul>
<li><a class="reference internal" href="#intel-tools">2.1 Intel tools</a><ul>
<li><a class="reference internal" href="#intel-compiler">2.1.1 Intel compiler</a></li>
<li><a class="reference internal" href="#mkl-libraries">2.1.2 <code class="docutils literal notranslate"><span class="pre">MKL</span></code> libraries</a></li>
</ul>
</li>
<li><a class="reference internal" href="#todo-libint">2.2 TODO Libint</a></li>
<li><a class="reference internal" href="#todo-ctf">2.3 TODO CTF</a></li>
</ul>
</li>
<li><a class="reference internal" href="#input">3 Input</a><ul>
<li><a class="reference internal" href="#yaml">3.1 Yaml</a><ul>
<li><a class="reference internal" href="#disabling-steps">3.1.1 Disabling steps</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#todo-developer-s-corner">4 TODO Developer’s corner</a><ul>
<li><a class="reference internal" href="#todo-writing-documentation">4.1 TODO Writing documentation</a></li>
<li><a class="reference internal" href="#todo-adding-new-algorithms">4.2 TODO Adding new algorithms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#technical-details">5 Technical details</a><ul>
<li><a class="reference internal" href="#binary-tensor-file-format">5.1 Binary tensor file format</a><ul>
<li><a class="reference internal" href="#header">5.1.1 Header</a><ul>
<li><a class="reference internal" href="#tensor-flags">5.1.1.1 Tensor flags</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dimension-information">5.1.2 Dimension information</a><ul>
<li><a class="reference internal" href="#dimension-flags">5.1.2.1 Dimension flags</a></li>
</ul>
</li>
<li><a class="reference internal" href="#variable-chunks">5.1.3 Variable chunks</a><ul>
<li><a class="reference internal" href="#symmetry-chunk">5.1.3.1 Symmetry chunk</a><ul>
<li><a class="reference internal" href="#symmetry-flags">5.1.3.1.1 Symmetry flags</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#tensor-data">5.1.4 Tensor data</a><ul>
<li><a class="reference internal" href="#sequential-values">5.1.4.1 Sequential values</a></li>
<li><a class="reference internal" href="#index-value-storage">5.1.4.2 Index-value storage</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#fourier-transformed-overlap-densities">5.2 Fourier Transformed Overlap Densities</a><ul>
<li><a class="reference internal" href="#id12">5.2.1 Header</a></li>
<li><a class="reference internal" href="#overlap-densities">5.2.2 Overlap densities</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fourier-transformed-overlap-densities-binary">5.3 Fourier Transformed Overlap Densities - Binary</a><ul>
<li><a class="reference internal" href="#id15">5.3.1 Header</a></li>
<li><a class="reference internal" href="#data-chunks">5.3.2 Data Chunks</a><ul>
<li><a class="reference internal" href="#real-part-of-chi">5.3.2.1 Real part of <span class="math notranslate nohighlight">\(\chi\)</span></a></li>
<li><a class="reference internal" href="#imaginary-part-of-chi">5.3.2.2 Imaginary part of <span class="math notranslate nohighlight">\(\chi\)</span></a></li>
<li><a class="reference internal" href="#real-part-of-chi-i-a">5.3.2.3 Real part of <span class="math notranslate nohighlight">\(\chi_i^a\)</span></a></li>
<li><a class="reference internal" href="#imaginary-part-of-chi-i-a">5.3.2.4 Imaginary part of <span class="math notranslate nohighlight">\(\chi_i^a\)</span></a></li>
<li><a class="reference internal" href="#eigenenergies-varepsilon-p">5.3.2.5 Eigenenergies <span class="math notranslate nohighlight">\(\varepsilon_p\)</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#algorithms">6 Algorithms</a><ul>
<li><a class="reference internal" href="#moreader">6.1 MoReader</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="index.html"
                          title="previous chapter">SiSi4S</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/manual.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="index.html" title="SiSi4S"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SiSi4S  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">1 Introduction</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 1980, Alejandro Gallo.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.1.1.
    </div>
  </body>
</html>