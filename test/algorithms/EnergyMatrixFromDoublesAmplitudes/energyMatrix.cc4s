%ParticleHoleCoulombVertexReader [
%  (file "../../resources/ParticleHoleCoulombVertex.bin")
%] [
%  ParticleHoleCoulombVertex HoleEigenEnergies ParticleEigenEnergies
%].

CoulombVertexReader [
  (file "../../resources/CoulombVertex.bin")
] [
  CoulombVertex HoleEigenEnergies ParticleEigenEnergies
].

SliceCoulombVertex [
  CoulombVertex HoleEigenEnergies ParticleEigenEnergies
] [
  ParticleHoleCoulombVertex
].

ParticleHoleCoulombIntegrals [
  ParticleHoleCoulombVertex
] [
  PPHHCoulombIntegrals
].

DrccdEnergyFromCoulombVertex [
  PPHHCoulombIntegrals
  ParticleHoleCoulombVertex
  HoleEigenEnergies ParticleEigenEnergies
  % just calculate MP2
  (maxIterations 1)
] [
  DrccdEnergy 
  DrccdDoublesAmplitudes
].

EnergyMatrixFromDoublesAmplitudes [
  ParticleHoleCoulombVertex
  (DoublesAmplitudes DrccdDoublesAmplitudes)
] [
  EnergyMatrix
].
