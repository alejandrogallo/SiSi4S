GenerateRandomMatrix [(m 5000) (n 5000)] [(Result RealA)].
GenerateRandomMatrix [(m 5000) (n 5000)] [(Result ImagA)].
GenerateRandomMatrix [(m 5000) (n 5000)] [(Result RealB)].
GenerateRandomMatrix [(m 5000) (n 5000)] [(Result ImagB)].

GenerateRandomMatrix [(m 5000) (n 5000)] [(Result RealC)].
GenerateRandomMatrix [(m 5000) (n 5000)] [(Result ImagC)].

% Re(C) = Re(A)*Re(B)
TensorContraction [
  (A RealA) (AIndex "ik") (B RealB) (BIndex "kj")
  (ResultIndex "ij")
] [
  (Result RealC)
].
% Re(C) -= Im(A)*Im(B)
TensorContraction [
  (A ImagA) (AIndex "ik") (B RealB) (BIndex "kj")
  (ResultIndex "ij")
  (alpha -1) (beta 1)
] [
  (Result RealC)
].

% Im(C) = Im(A)*Re(B)
TensorContraction [
  (A ImagA) (AIndex "ik") (B RealB) (BIndex "kj")
  (ResultIndex "ij")
] [
  (Result ImagC)
].
% Im(C) += Re(A)*Im(B)
TensorContraction [
  (A RealA) (AIndex "ik") (B ImagB) (BIndex "kj")
  (ResultIndex "ij")
  (alpha +1) (beta 1)
] [
  (Result ImagC)
].

GenerateRandomComplexMatrix [(m 5000) (n 5000)] [(Result A)].
GenerateRandomComplexMatrix [(m 5000) (n 5000)] [(Result B)].

GenerateRandomComplexMatrix [(m 5000) (n 5000)] [(Result C)].

ComplexTensorContraction [
  A (AIndex "ik")
  B (BIndex "kj")
  (ResultIndex "ij")
] [
  (Result C)
].

ComplexTensorNorm [(A C)] [Norm].
TensorNorm [(A RealC)] [(Norm NormReal)].
TensorNorm [(A ImagC)] [(Norm NormImag)].

